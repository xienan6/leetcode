DP.  
Time complexity O(n^2m), Space complexity O(nm)