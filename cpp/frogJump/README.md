DFS + prune.  
Time complexity O(-), Space complexity O(-)