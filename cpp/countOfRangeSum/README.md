S(i,j)=sum(i)-sum(j). Use a stack to sort S(i,j) to S(i,0) and find the lower_bound and the upper_bound.  
Time complexity O(nlogn), Space complexity O(n)